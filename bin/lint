#!/usr/bin/env bash
set -e

node_modules/.bin/flow

# run the 'standard-js' linter on the source code
errors=$(node_modules/.bin/standard -v 'src/**/*.js' | grep -v no-undef | wc -l | tr -d ' ')
if [ $errors -gt 0 ]; then
  echo Found standardJS errors in the source code:
  node_modules/.bin/standard -v 'src/**/*.js' | grep -v no-undef
  exit 1
fi


# run the 'standard-js' linter on the test code
errors=$(node_modules/.bin/standard -v 'features/**/*.js' | grep -v no-unused-expressions | grep -v no-eval | wc -l | tr -d ' ')
if [ $errors -gt 0 ]; then
  echo Found standardJS errors in the test code:
  node_modules/.bin/standard -v 'features/**/*.js' | grep -v no-unused-expressions | grep -v no-eval
  exit 1
fi

# lint the standard in the Markdown file
node_modules/.bin/standard-markdown

node_modules/.bin/dependency-lint
